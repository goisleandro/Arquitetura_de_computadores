# Arquitetura_de_computadores

Parte I:
Criar o módulo escrito em linguagem C, chamado matrix_lib.cu, usando a biblioteca CUDA NVIDIA e processamento paralelo na GPGPU NVIDIA Tesla C2075, para implementar duas funções de operações aritméticas com matrizes estão descritas abaixo.

a. Função int scalar_matrix_mult(float scalar_value, struct matrix *matrix)
Essa função recebe um valor escalar e uma matriz como argumentos de entrada e calcula o produto do valor escalar pela matriz utilizando CUDA. Cada função kernel deve calcular o resultado do produto entre o valor escalar e um dos elementos da matriz (ou mais de um elemento se o dataset for maior que o número de threads do GRID). O resultado da operação deve ser retornado na matriz de entrada. Em caso de sucesso, a função deve retornar o valor 1. Em caso de erro, a função deve retornar 0.

b. Fução int matrix_matrix_mult(struct matrix *matrixA, struct matrix * matrixB, struct matrix * matrixC)
Essa função recebe 3 matrizes como argumentos de entrada e calcula o valor do produto da matriz A pela matriz B utilizando CUDA. Cada função kernel deve calcular o resultado referente a um dos elementos da matriz C (ou mais de um elemento se o dataset for maior que o número de threads do GRID). O resultado da operação deve ser retornado na matriz C. Em caso de sucesso, a função deve retornar o valor 1. Em caso de erro, a função deve retornar 0.

c. Função int set_grid_size(int threads_per_block, int max_blocks_per_grid)
Essa função recebe o número de threads por bloco e o número máximo de blocos por grid que devem ser usados como parâmetros para disparar os threads (funções kernel) em paralelo durante o processamento das operações aritméticas com as matrizes e deve ser chamada pelo programa principal antes das outras funções. Caso não seja chamada, o valor default do número de threads por bloco do módulo é 256 e do número de blocos por grid é 4096. Os valores limites para a GPGPU NVIDIA são 1024 para o número de threads por bloco e 65535 para o número de blocos por grid. Se algum dos valores passados como argumento para a função extrapolar um dos valores máximos, os valores default deverão ser usados e a função deve retornar 0 para indicar erro. Caso contrário, os valores passados devem ser usados e a função deve retornar 1 para indicar que os valores foram aceitos com sucesso.

Parte II:
Crie um programa em linguagem C, chamado matrix_lib_test.c, que implemente um código para testar a biblioteca matrix_lib.c. Esse programa deve receber um valor escalar float, a dimensão da primeira matriz (A), a dimensão da segunda matriz (B), o número de threads por bloco a serem disparadas, o número máximo de blocos por GRID a serem usados, e o nome de quatro arquivos binários de floats na linha de comando de execução. O programa deve inicializar as duas matrizes (A e B) respectivamente a partir dos dois primeiros arquivos binários de floats e uma terceira matriz (C) com zeros. A função set_grid_size deve ser chamada com os respectivos valores dos argumentos passados na linha de comando. A função scalar_matrix_mult deve ser chamada com os seguintes argumentos: o valor escalar fornecido e a primeira matriz (A). O resultado (retornado na matriz A) deve ser armazenado em um arquivo binário usando o nome do terceiro arquivo de floats. Depois, a função matrix_matrix_mult deve ser chamada com os seguintes argumentos: a matriz A resultante da função scalar_matrix_mult, a segunda matriz (B) e a terceira matriz (C). O resultado (retornado na matriz C) deve ser armazenado com o nome do quarto arquivo de floats.
